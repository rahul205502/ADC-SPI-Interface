
‚ö°Ô∏è Dual-Channel ADC SPI Controller (Verilog HDL)

This project implements a robust **Serial Peripheral Interface (SPI)** master controller, named `ADC2`, in **Verilog HDL**. Its purpose is to configure and acquire data from a dual-channel, 14-bit Analog-to-Digital Converter (ADC). The controller is synchronized by a clock divided down from a high-frequency system clock.

## ‚öôÔ∏è Key Design Features

### Clock and Timing
* **System Clock (`clk`):** Assumed 50 MHz (20 ns period).
* **Clock Divider:** Divides the input clock by 25.
* **State Machine Clock (`clk_out`):** Operates at $f_{clk}/25$, resulting in 2 MHz.

### SPI Interface Signals

| Signal Name | Direction | Description |
| :--- | :--- | :--- |
| `spi_sck` | Output | Serial Clock generated by the master. |
| `amp_cs` | Output | Active-low Chip Select for the ADC. |
| `spi_mosi` | Output | Carries 8 bits of gain configuration data. |
| `spi_miso` | Input | Serial input carrying the ADC conversion results. |
| `adc_conv` | Output | Active-high pulse to initiate the ADC conversion cycle. |

### Data Acquisition Sequence (FSM)

The Finite State Machine (FSM) controls a multi-step data acquisition sequence:

1.  **Gain Setting (States 4-6):** Transmits an 8-bit gain configuration (8'b00010001) MSB-first while `amp_cs` is held low.
2.  **Idle/Delay (States 7-10):** Introduces a necessary time delay.
3.  **Conversion Start (States 16-18):** `adc_conv` is pulsed high for one `clk_out` cycle to initiate the ADC conversion.
4.  **Data Acquisition (States 20-23):** Generates **34 clock pulses** on `spi_sck` to receive the serial data from `spi_miso`.

## üìä Data Alignment (34-Bit Stream)

The ADC returns data for two 14-bit channels in a single 34-bit stream, which the controller captures and separates into the 14-bit outputs `adc_data1` and `adc_data2`.

The full data stream alignment is as follows:

| Bit Position (Clock Count) | Content | Channel/Type | Register Captured |
| :---: | :---: | :---: | :---: |
| **1 - 2** | `2'bzz` | Ignored/High-Z | None |
| **3 - 16** | 14 bits | Channel A | `adc_data1[13:0]` |
| **17 - 18** | `2'bzz` | Ignored/High-Z | None |
| **19 - 32** | 14 bits | Channel B | `adc_data2[13:0]` |
| **33 - 34** | `2'bzz` | Ignored/High-Z | None |

The controller captures and separates these into the 14-bit outputs `adc_data1` and `adc_data2`.

## ‚úÖ Verification

The design is verified using the self-checking testbench `adc_tb.v`, which emulates the ADC's serial data transmission on `spi_miso`. It compares the captured data (`adc_data1`, `adc_data2`) against expected values ($E_1$ and $E_2$) and prints a **PASS** or **FAIL** message.
